{% load static %}
<div>
    <a class="header-link" href="{% url 'dashboard' %}">
        <!-- <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#44b0d5"
            stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="icon icon-tabler icon-tabler-headphones">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M4 13m0 2a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v3a2 2 0 0 1 -2 2h-1a2 2 0 0 1 -2 -2z" />
            <path d="M15 13m0 2a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v3a2 2 0 0 1 -2 2h-1a2 2 0 0 1 -2 -2z" />
            <path d="M4 15v-3a8 8 0 0 1 16 0v3" />
        </svg> -->
        <canvas id="logoCanvas" width="60" height="60"></canvas>
        <h1>{{titulo_pagina}}</h1>
    </a>
</div>
<script>
    (function () {
        function initCanvas() {
            const canvas = document.getElementById('logoCanvas');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const img = new Image();

            img.onload = function () {
                canvas.width = 60;
                canvas.height = 60;
                ctx.drawImage(img, 0, 0, 60, 60);

                const imageData = ctx.getImageData(0, 0, 60, 60);
                const data = imageData.data;

                for (let i = 0; i < data.length; i += 4) {
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];

                    if (r > 240 && g > 240 && b > 240) {
                        data[i + 3] = 0;
                    }
                }

                ctx.putImageData(imageData, 0, 0);
            };

            // IMPORTANTE: Usar template tag de Django
            img.src = "/static/img/Audiobooks_fondo.ico";
        }

        // Ejecutar
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initCanvas);
        } else {
            initCanvas();
        }
    })();
</script>